{"pageProps":{"title":"HTML5 File Upload without jQuery","description":"In this blog post, I’ll explain how to use HTML 5, to read information about file(s) selected by users, and to upload the file(s) on a server. You might want to do is let the user upload the selected file or files to a server. This can be done asynchronously very easily.","date":"2015-05-27T07:03:15.750Z","lastmod":"2016-09-01T16:21:45.027Z","slug":"html5-file-upload-without-jquery","categories":["Web-Development","Development"],"tags":["JavaScript","HTML"],"thumbnail":"http://i1135.photobucket.com/albums/m637/Maer007/WebSnippet/th_1432710174026_zps9kowrird.png","image":"http://i1135.photobucket.com/albums/m637/Maer007/WebSnippet/1432710174026_zps9kowrird.png","source":"","content":"\n\nIn this blog post, I’ll explain how to use HTML 5, to read information about file(s) selected by users, and to upload the file(s) on a server. You might want to do is let the user upload the selected file or files to a server. This can be done asynchronously very easily.\n\nThe [File API](https://developer.mozilla.org/en-US/docs/Web/API/File) is one of the most interesting features added with HTML 5\\. Now we can fetch and display file(s) information before they are uploaded on the server, and we can send them without posting a form.\n\nWe’ll see how to access file(s) information when they are selected by users, and then upload them asynchronously using an Ajax Request without jQuery.\n\n## Show File information\n\nAccess information of a file selected by the user. Here is the HTML code :\n\n    <input type=\"file\" id=\"fileinput\" />\n    <p id=\"info\"></p>\n\nWhen the user choose a file, the 'change' event is fired on the input element, so we can listen for it :\n\n    document.querySelector('#fileinput').addEventListener('change', function(){\n\n    \tif(this.files.length===0)\n    \t\treturn;\n\n    \t// gets first selected file\n        var file = this.files[0]; \n\n        document.querySelector('#info').innerText = \n        \t'Name: '+ file.name+\n        \t', Size: '+file.size +\n        \t', Type: '+file.type +\n        \t', Last Modified: ' + file.lastModified;\n\n    }, false);\n\nAs you can see, the File API is quite simple to use, it adds the `files` property on the HTMLInputElement. As you may have noticed, we retrieved the chosen file, by accessing the index 0 of the FileList collection : `this.files[0]`. \n\n## Previewing Files\n\nAs we can read the file(s) information, we can also read the content of the file, this, for example, can allow us to preview selected files before upload.   \nLet’s see an example with previewing images, we make little bit changes to previous example.\n\n    <input type=\"file\" id=\"fileinput\" />\n    <img id=\"preview\">\n    <p id=\"info\"></p>\n\nHere is JavaScript code to manage the selected file(s):\n\n    document.querySelector('#fileinput').addEventListener('change', function(){\n\n    \tif(this.files.length===0)\n    \t\treturn;\n\n    \t// gets first selected file\n        var file = this.files[0]; \n\n        document.querySelector('#info').innerText = \n        \t'Name: '+ file.name+\n        \t', Size: '+file.size +\n        \t', Type: '+file.type +\n        \t', Last Modified: ' + file.lastModified;\n\n        // Using FileReader to display the image content\n        var reader = new FileReader();\n        reader.onload = function(e) { \n        \tdocument.querySelector('#preview').src = e.target.result;\n        };\n        reader.readAsDataURL(file);\n\n    }, false);\n\nHere we introduced the [FileReader](https://developer.mozilla.org/en-US/docs/Web/API/FileReader) object, that allow us to asynchronously read the contents of files.  \nInstantiate the object with the `new FileReader()`, then tell the object to read the data from the file with the method `readAsDataURL`.  \nThe `onload` method is called after the content is read by the object like an event, then the content of the file is assigned to the image `src` attribute: `document.querySelector('#preview').src = e.target.result;`\n\n## Upload The files\n\nNow we will upload files using [XMLHttpRequest](https://developer.mozilla.org/en/DOM/XMLHttpRequest/Using_XMLHttpRequest) (Ajax). For each files selected by the user we will create an HTTP request to send the file to the server.   \nFirst create a function to upload a file using [XMLHttpRequest](https://developer.mozilla.org/en/DOM/XMLHttpRequest/Using_XMLHttpRequest):\n\n    function uploadFile(file){\n        var url = '/file/image';\n        var xhr = new XMLHttpRequest();\n        var fd = new FormData();\n        xhr.open(\"POST\", url, true);\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState === 4 && xhr.status === 200) {\n                // Every thing ok, file uploaded\n                console.log(xhr.responseText); // handle response.\n            } else if(xhr.readyState == 4){\n            \t// with some error\n    \t\t\tconsole.log(xhr.responseText); // handle response.\n            }\n        };\n        fd.append(\"uploadfile\", file);\n        xhr.send(fd);\n    }\n\nThis function will create an ajax request (POST) on the url and send the file in the `upload_file` request parameter. Here we introduced the FormData object, that allow us to easily construct a set of key/value pairs representing form fields and their values, which can then be easily sent using the XMLHttpRequest send() method. Now we’ll connect the `uploadFile` function to the javascript that manage the selected files :\n\nHere is HTML:\n\n    <input type=\"file\" id=\"fileinput\" />\n    <img id=\"preview\">\n    <p id=\"info\"></p>\n    <button id=\"uploadfiles\">Upload file</button>\n\nHere is JavaScript:\n\n    document.querySelector('#uploadfiles').addEventListener('change', function () {\n        var files = this.files;\n        for(var i=0; i<files.length; i++){\n            uploadFile(this.files[i]); // call the function to upload the file\n        }\n    }, false);\n\nThat is all. You can send other form fields in such way.","permalink":"/post/html5-file-upload-without-jquery","site":{"categories":[{"name":"Algorithm","count":1},{"name":"Design","count":10},{"name":"Development","count":38},{"name":"Interview","count":4},{"name":"Mobile-Development","count":1},{"name":"Resources","count":15},{"name":"System Design","count":2},{"name":"System-Design","count":2},{"name":"Tools","count":1},{"name":"Web Management","count":5},{"name":"Web-Development","count":37}],"tags":[{"name":".NET","count":2},{"name":"Algorithm","count":1},{"name":"AngularJS","count":4},{"name":"CSS","count":7},{"name":"HTML","count":4},{"name":"Interview","count":8},{"name":"JavaScript","count":27},{"name":"Mobile","count":1},{"name":"Node.JS","count":8},{"name":"React","count":1},{"name":"Tools","count":1}]}},"__N_SSG":true}